// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`modules/platform/github/index addAssignees(issueNo, assignees) should add the given assignees to the issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "assignees": Array [
        "someuser",
        "someotheruser",
      ],
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "42",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/42/assignees",
  },
]
`;

exports[`modules/platform/github/index addReviewers(issueNo, reviewers) should add the given reviewers to the PR 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "reviewers": Array [
        "someuser",
        "someotheruser",
      ],
      "team_reviewers": Array [
        "someteam",
      ],
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "72",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls/42/requested_reviewers",
  },
]
`;

exports[`modules/platform/github/index createPr() should create a draftPR if set in the settings 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "base": "master",
      "body": "This is a result of a draft",
      "draft": true,
      "head": "some:some-branch",
      "title": "PR draft",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "112",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls",
  },
]
`;

exports[`modules/platform/github/index createPr() should create and return a PR object 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "base": "dev",
      "body": "Hello world",
      "draft": false,
      "head": "some:some-branch",
      "title": "The Title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "95",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls",
  },
  Object {
    "body": Array [
      "deps",
      "renovate",
    ],
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "19",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/123/labels",
  },
]
`;

exports[`modules/platform/github/index createPr() should use defaultBranch 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "base": "master",
      "body": "Hello world",
      "draft": false,
      "head": "some:some-branch",
      "title": "The Title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "98",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls",
  },
]
`;

exports[`modules/platform/github/index deleteLabel(issueNo, label) should delete the label 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "DELETE",
    "url": "https://api.github.com/repos/some/repo/issues/42/labels/rebase",
  },
]
`;

exports[`modules/platform/github/index ensureComment add comment if not found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "body": Object {
      "body": "### some-subject

some
content",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "44",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments",
  },
]
`;

exports[`modules/platform/github/index ensureComment add updates comment if necessary 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "body": Object {
      "body": "### some-subject

some
content",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "44",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/issues/comments/1234",
  },
]
`;

exports[`modules/platform/github/index ensureComment adds comment if found in closed PR list 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/2499/comments?per_page=100",
  },
  Object {
    "body": Object {
      "body": "### some-subject

some
content",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "44",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/2499/comments",
  },
]
`;

exports[`modules/platform/github/index ensureComment handles comment with no description 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
]
`;

exports[`modules/platform/github/index ensureComment skips comment 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
]
`;

exports[`modules/platform/github/index ensureCommentRemoval deletes comment by content if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "DELETE",
    "url": "https://api.github.com/repos/some/repo/issues/comments/1234",
  },
]
`;

exports[`modules/platform/github/index ensureCommentRemoval deletes comment by topic if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "DELETE",
    "url": "https://api.github.com/repos/some/repo/issues/comments/1234",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() closes others if ensuring only once 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/3",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() creates issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "body": "new-content",
      "labels": Array [],
      "title": "new-title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "54",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() creates issue if not ensuring only once 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/1",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() creates issue if reopen flag false and issue is not open 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
  Object {
    "body": Object {
      "body": "new-content",
      "labels": Array [],
      "title": "title-2",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "52",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() creates issue with labels 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "body": "new-content",
      "labels": Array [
        "Renovate",
        "Maintenance",
      ],
      "title": "new-title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "78",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() deletes if duplicate 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "state": "closed",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "18",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/issues/1",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() does not create issue if ensuring only once 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() does not create issue if reopen flag false and issue is already open 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() skips update if unchanged 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() updates issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
  Object {
    "body": Object {
      "body": "newer-content",
      "state": "open",
      "title": "title-3",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "57",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
]
`;

exports[`modules/platform/github/index ensureIssue() updates issue with labels 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "560",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
  Object {
    "body": Object {
      "body": "newer-content",
      "labels": Array [
        "Renovate",
        "Maintenance",
      ],
      "state": "open",
      "title": "title-3",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "93",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/issues/2",
  },
]
`;

exports[`modules/platform/github/index ensureIssueClosing() closes issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "531",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "state": "closed",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "18",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`modules/platform/github/index findIssue() finds issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "531",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`modules/platform/github/index findIssue() returns null if no issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$count": "Int",
          "$cursor": "String",
          "$name": "String!",
          "$owner": "String!",
          "$user": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "issues": Object {
            "__args": Object {
              "after": "$cursor",
              "filterBy": Object {
                "createdBy": "$user",
              },
              "first": "$count",
              "orderBy": Object {
                "direction": "DESC",
                "field": "UPDATED_AT",
              },
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
      "variables": Object {
        "count": 100,
        "cursor": null,
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "531",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index findPr(branchName, prTitle, state) caches pr list 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index findPr(branchName, prTitle, state) returns true if no title and all state 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index findPr(branchName, prTitle, state) returns true if not open 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index getBranchPr(branchName) aborts reopen if PR is too old 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index getBranchPr(branchName) aborts reopening if PR reopening fails 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "body": Object {
      "ref": "refs/heads/somebranch",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "31",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/git/refs",
  },
]
`;

exports[`modules/platform/github/index getBranchPr(branchName) aborts reopening if branch recreation fails 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "body": Object {
      "ref": "refs/heads/somebranch",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "31",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/git/refs",
  },
  Object {
    "body": Object {
      "state": "open",
      "title": "old title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "36",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/pulls/91",
  },
]
`;

exports[`modules/platform/github/index getBranchPr(branchName) should cache and return the PR object 1`] = `
Object {
  "displayNumber": "Pull Request #91",
  "number": 91,
  "sourceBranch": "somebranch",
  "sourceRepo": "some/repo",
  "state": "open",
  "title": "Some title",
}
`;

exports[`modules/platform/github/index getBranchPr(branchName) should cache and return the PR object 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index getBranchPr(branchName) should cache and return the PR object in fork mode 1`] = `
Object {
  "displayNumber": "Pull Request #90",
  "number": 90,
  "sourceBranch": "somebranch",
  "sourceRepo": "other/repo",
  "state": "open",
  "title": "Some title",
}
`;

exports[`modules/platform/github/index getBranchPr(branchName) should cache and return the PR object in fork mode 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/forks",
  },
  Object {
    "body": Object {
      "force": true,
      "sha": "1234",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "27",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/forked/repo/git/refs/heads/master",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index getBranchPr(branchName) should reopen and cache autoclosed PR 1`] = `
Object {
  "displayNumber": "Pull Request #91",
  "number": 91,
  "sourceBranch": "somebranch",
  "sourceRepo": "some/repo",
  "state": "open",
  "title": "old title",
}
`;

exports[`modules/platform/github/index getBranchPr(branchName) should reopen and cache autoclosed PR 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "body": Object {
      "ref": "refs/heads/somebranch",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "31",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/git/refs",
  },
  Object {
    "body": Object {
      "state": "open",
      "title": "old title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "36",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/pulls/91",
  },
]
`;

exports[`modules/platform/github/index getBranchPr(branchName) should return null if no PR exists 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index getBranchStatus() defaults to pending 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs?per_page=100",
  },
]
`;

exports[`modules/platform/github/index getBranchStatus() returns success if ignoreTests true 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index getBranchStatus() should fail if a check run has failed 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs?per_page=100",
  },
]
`;

exports[`modules/platform/github/index getBranchStatus() should fail if a check run is pending 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs?per_page=100",
  },
]
`;

exports[`modules/platform/github/index getBranchStatus() should pass through failed 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs?per_page=100",
  },
]
`;

exports[`modules/platform/github/index getBranchStatus() should pass through success 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs?per_page=100",
  },
]
`;

exports[`modules/platform/github/index getBranchStatus() should succeed if no status and all passed check runs 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs?per_page=100",
  },
]
`;

exports[`modules/platform/github/index getBranchStatusCheck returns null 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`modules/platform/github/index getBranchStatusCheck returns state if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`modules/platform/github/index getJsonFile() returns file content 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/contents/file.json",
  },
]
`;

exports[`modules/platform/github/index getJsonFile() returns file content from branch or tag 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/contents/file.json?ref=dev",
  },
]
`;

exports[`modules/platform/github/index getJsonFile() returns file content from given repo 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "different",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "400",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/different/repo/contents/file.json",
  },
]
`;

exports[`modules/platform/github/index getJsonFile() returns file content in json5 format 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/contents/file.json5",
  },
]
`;

exports[`modules/platform/github/index getJsonFile() throws on errors 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/contents/file.json",
  },
]
`;

exports[`modules/platform/github/index getJsonFile() throws on malformed JSON 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/contents/file.json",
  },
]
`;

exports[`modules/platform/github/index getPr(prNo) should return PR 1`] = `
Object {
  "displayNumber": "Pull Request #2500",
  "number": 2500,
  "sourceBranch": "renovate/jest-monorepo",
  "sourceRepo": "some/repo",
  "state": "open",
  "title": "chore(deps): update dependency jest to v23.6.0",
}
`;

exports[`modules/platform/github/index getPr(prNo) should return PR 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
]
`;

exports[`modules/platform/github/index getPr(prNo) should return a PR object - 0 1`] = `
Object {
  "createdAt": "01-01-2022",
  "displayNumber": "Pull Request #1234",
  "hasAssignees": true,
  "labels": Array [
    "foo",
    "bar",
  ],
  "number": 1234,
  "sha": "def",
  "sourceBranch": "some/branch",
  "state": "merged",
  "title": "Some title",
}
`;

exports[`modules/platform/github/index getPr(prNo) should return a PR object - 0 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;

exports[`modules/platform/github/index getPr(prNo) should return a PR object - 1 1`] = `
Object {
  "displayNumber": "Pull Request #1234",
  "hasAssignees": true,
  "hasReviewers": true,
  "number": 1234,
  "sourceBranch": "some/branch",
  "state": "open",
  "title": "Some title",
}
`;

exports[`modules/platform/github/index getPr(prNo) should return a PR object - 1 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;

exports[`modules/platform/github/index getPr(prNo) should return a PR object - 2 1`] = `
Object {
  "displayNumber": "Pull Request #1234",
  "number": 1234,
  "sourceBranch": "some/branch",
  "state": "open",
  "title": "Some title",
}
`;

exports[`modules/platform/github/index getPr(prNo) should return a PR object - 2 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;

exports[`modules/platform/github/index getPr(prNo) should return null if no PR is returned from GitHub 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;

exports[`modules/platform/github/index getRepoForceRebase should detect repoForceRebase 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`modules/platform/github/index getRepoForceRebase should handle 403 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`modules/platform/github/index getRepoForceRebase should handle 404 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`modules/platform/github/index getRepoForceRebase should throw 401 1`] = `"Response code 401 (Unauthorized)"`;

exports[`modules/platform/github/index getRepoForceRebase should throw 401 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`modules/platform/github/index getRepos should return an array of repos 1`] = `
Array [
  "a/b",
  "c/d",
]
`;

exports[`modules/platform/github/index getRepos should return an array of repos 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
]
`;

exports[`modules/platform/github/index getVulnerabilityAlerts() handles network error 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
              "states": Array [
                "OPEN",
              ],
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
      "variables": Object {},
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "700",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index getVulnerabilityAlerts() returns array if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
              "states": Array [
                "OPEN",
              ],
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
      "variables": Object {},
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "700",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index getVulnerabilityAlerts() returns empty if disabled 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
              "states": Array [
                "OPEN",
              ],
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
      "variables": Object {},
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "700",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index getVulnerabilityAlerts() returns empty if error 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
              "states": Array [
                "OPEN",
              ],
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
      "variables": Object {},
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "700",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index initPlatform() should support custom endpoint 1`] = `
Object {
  "endpoint": "https://ghe.renovatebot.com/",
  "gitAuthor": "undefined <user@domain.com>",
  "renovateUsername": "renovate-bot",
}
`;

exports[`modules/platform/github/index initPlatform() should support custom endpoint 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "ghe.renovatebot.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "HEAD",
    "url": "https://ghe.renovatebot.com/",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "ghe.renovatebot.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://ghe.renovatebot.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "ghe.renovatebot.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://ghe.renovatebot.com/user/emails",
  },
]
`;

exports[`modules/platform/github/index initPlatform() should support custom endpoint without version 1`] = `
Object {
  "endpoint": "https://ghe.renovatebot.com/",
  "gitAuthor": "undefined <user@domain.com>",
  "renovateUsername": "renovate-bot",
}
`;

exports[`modules/platform/github/index initPlatform() should support default endpoint no email access 1`] = `
Object {
  "endpoint": "https://api.github.com/",
  "gitAuthor": undefined,
  "renovateUsername": "renovate-bot",
}
`;

exports[`modules/platform/github/index initPlatform() should support default endpoint no email access 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/emails",
  },
]
`;

exports[`modules/platform/github/index initPlatform() should support default endpoint no email result 1`] = `
Object {
  "endpoint": "https://api.github.com/",
  "gitAuthor": undefined,
  "renovateUsername": "renovate-bot",
}
`;

exports[`modules/platform/github/index initPlatform() should support default endpoint no email result 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/emails",
  },
]
`;

exports[`modules/platform/github/index initPlatform() should support default endpoint with email 1`] = `
Object {
  "endpoint": "https://api.github.com/",
  "gitAuthor": "undefined <user@domain.com>",
  "renovateUsername": "renovate-bot",
}
`;

exports[`modules/platform/github/index initPlatform() should support default endpoint with email 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/emails",
  },
]
`;

exports[`modules/platform/github/index initPlatform() should support gitAuthor and username 1`] = `
Object {
  "endpoint": "https://api.github.com/",
  "gitAuthor": "renovate@whitesourcesoftware.com",
  "renovateUsername": "renovate-bot",
}
`;

exports[`modules/platform/github/index initPlatform() should throw if user failure 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
]
`;

exports[`modules/platform/github/index initRepo detects fork default branch mismatch 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`modules/platform/github/index initRepo detects fork default branch mismatch 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/forks",
  },
  Object {
    "body": Object {
      "ref": "refs/heads/master",
      "sha": "1234",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "40",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/forked/repo/git/refs",
  },
  Object {
    "body": Object {
      "default_branch": "master",
      "name": "repo",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "41",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/forked/repo",
  },
  Object {
    "body": Object {
      "force": true,
      "sha": "1234",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "27",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/forked/repo/git/refs/heads/master",
  },
]
`;

exports[`modules/platform/github/index initRepo should fork when forkMode 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`modules/platform/github/index initRepo should fork when forkMode 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/forks",
  },
]
`;

exports[`modules/platform/github/index initRepo should merge 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`modules/platform/github/index initRepo should merge 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index initRepo should not guess at merge 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`modules/platform/github/index initRepo should not guess at merge 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index initRepo should rebase 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`modules/platform/github/index initRepo should rebase 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index initRepo should squash 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`modules/platform/github/index initRepo should squash 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index initRepo should throw error if archived 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index initRepo should throw error if renamed 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index initRepo should update fork when forkMode 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`modules/platform/github/index initRepo should update fork when forkMode 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/forks",
  },
  Object {
    "body": Object {
      "force": true,
      "sha": "1234",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "27",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/forked/repo/git/refs/heads/master",
  },
]
`;

exports[`modules/platform/github/index initRepo throws not-found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`modules/platform/github/index massageMarkdown(input) returns not-updated pr body for GHE 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "github.company.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "HEAD",
    "url": "https://github.company.com/",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "github.company.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://github.company.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "github.company.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://github.company.com/user/emails",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "351",
      "content-type": "application/json",
      "host": "github.company.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://github.company.com/graphql",
  },
]
`;

exports[`modules/platform/github/index massageMarkdown(input) returns updated pr body 1`] = `"[https://github.com/foo/bar/issues/5](https://togithub.com/foo/bar/issues/5) plus also [a link](https://togithub.com/foo/bar/issues/5)"`;

exports[`modules/platform/github/index mergePr(prNo) - autodetection should give up 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": Object {
      "merge_method": "squash",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": Object {
      "merge_method": "merge",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "24",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
]
`;

exports[`modules/platform/github/index mergePr(prNo) - autodetection should try merge after squash 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": Object {
      "merge_method": "squash",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
]
`;

exports[`modules/platform/github/index mergePr(prNo) - autodetection should try rebase first 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1235/merge",
  },
]
`;

exports[`modules/platform/github/index mergePr(prNo) - autodetection should try squash after rebase 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1236/merge",
  },
]
`;

exports[`modules/platform/github/index mergePr(prNo) should handle merge error 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/merge",
  },
]
`;

exports[`modules/platform/github/index mergePr(prNo) should merge the PR 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "body": Object {
      "merge_method": "rebase",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "25",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/merge",
  },
]
`;

exports[`modules/platform/github/index setBranchStatus returns if already set 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`modules/platform/github/index setBranchStatus sets branch status 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
  Object {
    "body": Object {
      "context": "some-context",
      "description": "some-description",
      "state": "success",
      "target_url": "some-url",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "101",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/statuses/0d9c7726c3d628b7e28af234595cfd20febdbf8e",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/some-branch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`modules/platform/github/index updatePr(prNo, title, body) should update and close the PR 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "body": "Hello world again",
      "state": "closed",
      "title": "The New Title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "69",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;

exports[`modules/platform/github/index updatePr(prNo, title, body) should update the PR 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "__vars": Object {
          "$name": "String!",
          "$owner": "String!",
        },
        "repository": Object {
          "__args": Object {
            "name": "$name",
            "owner": "$owner",
          },
          "autoMergeAllowed": null,
          "defaultBranchRef": Object {
            "name": null,
            "target": Object {
              "oid": null,
            },
          },
          "hasIssuesEnabled": null,
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
      "variables": Object {
        "name": "repo",
        "owner": "some",
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "395",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": Object {
      "body": "Hello world again",
      "title": "The New Title",
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate, br",
      "authorization": "token 123test",
      "content-length": "52",
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "RenovateBot/0.0.0-semantic-release (https://github.com/renovatebot/renovate)",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;
