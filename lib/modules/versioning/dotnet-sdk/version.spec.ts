import { parseVersion } from './parser';
import { compare } from './version';

describe('modules/versioning/dotnet-sdk/version', () => {
  describe('compare', () => {
    test.each`
      x                                 | y                                 | expected
      ${'8'}                            | ${'8'}                            | ${0}
      ${'8'}                            | ${'9'}                            | ${-1}
      ${'9'}                            | ${'8'}                            | ${1}
      ${'8'}                            | ${'8.0'}                          | ${0}
      ${'8'}                            | ${'8.0.100'}                      | ${0}
      ${'8.0'}                          | ${'8'}                            | ${0}
      ${'8.0'}                          | ${'8.0'}                          | ${0}
      ${'8.0'}                          | ${'8.0.100'}                      | ${0}
      ${'8.0'}                          | ${'8.1'}                          | ${-1}
      ${'8.1'}                          | ${'8.0'}                          | ${1}
      ${'8.0.100'}                      | ${'8.0.101'}                      | ${-1}
      ${'8.0.101'}                      | ${'8.0.100'}                      | ${1}
      ${'8.0.100'}                      | ${'8.0.100'}                      | ${0}
      ${'9'}                            | ${'10'}                           | ${-1}
      ${'9.0'}                          | ${'10.0'}                         | ${-1}
      ${'9.0.0'}                        | ${'10.0.0'}                       | ${-1}
      ${'10'}                           | ${'9'}                            | ${1}
      ${'10.0'}                         | ${'9.0'}                          | ${1}
      ${'10.0.0'}                       | ${'9.0.0'}                        | ${1}
      ${'9.0.100-rc.1.24452.1'}         | ${'9.0.100-rc.2.24474.3'}         | ${-1}
      ${'9.0.100-rc.2.24474.3'}         | ${'9.0.100-rc.1.24452.1'}         | ${1}
      ${'9.0.100-rc.1.24452.1'}         | ${'9.0.100-rc.1.24452.1'}         | ${0}
      ${'9.0.100-rc.2.24474.3'}         | ${'10.0.100-preview.1.25120.3'}   | ${-1}
      ${'9.0.100-rc.2.24474.3'}         | ${'9.0.100-rc.2.24474.3'}         | ${0}
      ${'9.0.100-rc.2.24474.3'}         | ${'10.0.100-preview.1.25120.3'}   | ${-1}
      ${'9.0.100'}                      | ${'10.0.100-preview.1.25120.3'}   | ${-1}
      ${'10.0.100-preview.1.25120.3'}   | ${'9.0.100'}                      | ${1}
      ${'9.0.304'}                      | ${'10.0.100-preview.1.25120.3'}   | ${-1}
      ${'10.0.100-preview.1.25120.3'}   | ${'9.0.304'}                      | ${1}
      ${'10.0.100-preview.1.25120.3'}   | ${'9.0.100-rc.2.24474.3'}         | ${1}
      ${'10.0.100-preview.1.25120.3'}   | ${'10.0.100-preview.1.25120.3'}   | ${0}
      ${'10.0.100-preview.1.25120.3'}   | ${'10.0.100-preview.6.25358.103'} | ${-1}
      ${'10.0.100-preview.6.25358.103'} | ${'10.0.100-preview.1.25120.3'}   | ${1}
      ${'10.0.100-preview.6.25358.103'} | ${'10.0.100-preview.6.25358.103'} | ${0}
      ${'10.0.100-preview.6.25358.103'} | ${'10'}                           | ${-1}
      ${'10.0.100-preview.6.25358.103'} | ${'10.0'}                         | ${-1}
      ${'10.0.100-preview.6.25358.103'} | ${'10.0.100'}                     | ${-1}
      ${'10.0.100'}                     | ${'10.0.100-preview.6.25358.103'} | ${1}
    `('compare($x, $y) === $expected', ({ x, y, expected }) => {
      const a = parseVersion(x)!;
      const b = parseVersion(y)!;
      expect(a).toBeTruthy();
      expect(b).toBeTruthy();

      expect(compare(a, b)).toBe(expected);
    });
  });
});
