// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`platform/github addAssignees(issueNo, assignees) should add the given assignees to the issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"assignees\\":[\\"someuser\\",\\"someotheruser\\"]}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 42,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/42/assignees",
  },
]
`;

exports[`platform/github addReviewers(issueNo, reviewers) should add the given reviewers to the PR 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"reviewers\\":[\\"someuser\\",\\"someotheruser\\"],\\"team_reviewers\\":[\\"someteam\\"]}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 72,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls/42/requested_reviewers",
  },
]
`;

exports[`platform/github createPr() should create a draftPR if set in the settings 1`] = `
Object {
  "branchName": "some-branch",
  "displayNumber": "Pull Request #123",
  "isModified": false,
  "number": 123,
}
`;

exports[`platform/github createPr() should create a draftPR if set in the settings 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"title\\":\\"PR draft\\",\\"head\\":\\"some:some-branch\\",\\"base\\":\\"master\\",\\"body\\":\\"This is a result of a draft\\",\\"draft\\":true}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 112,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls",
  },
]
`;

exports[`platform/github createPr() should create and return a PR object 1`] = `
Object {
  "branchName": "some-branch",
  "displayNumber": "Pull Request #123",
  "isModified": false,
  "number": 123,
}
`;

exports[`platform/github createPr() should create and return a PR object 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"title\\":\\"The Title\\",\\"head\\":\\"some:some-branch\\",\\"base\\":\\"master\\",\\"body\\":\\"Hello world\\",\\"draft\\":false}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 98,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls",
  },
  Object {
    "body": "[\\"deps\\",\\"renovate\\"]",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 19,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/123/labels",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
  Object {
    "body": "{\\"state\\":\\"success\\",\\"description\\":\\"Renovate verified pull request\\",\\"context\\":\\"renovate/verify\\",\\"target_url\\":\\"https://github.com/renovatebot/renovate\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 149,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/statuses/0d9c7726c3d628b7e28af234595cfd20febdbf8e",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/some-branch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`platform/github createPr() should use defaultBranch 1`] = `
Object {
  "branchName": "some-branch",
  "displayNumber": "Pull Request #123",
  "isModified": false,
  "number": 123,
}
`;

exports[`platform/github createPr() should use defaultBranch 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"title\\":\\"The Title\\",\\"head\\":\\"some:some-branch\\",\\"base\\":\\"master\\",\\"body\\":\\"Hello world\\",\\"draft\\":false}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 98,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/pulls",
  },
]
`;

exports[`platform/github deleteLabel(issueNo, label) should delete the label 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "DELETE",
    "url": "https://api.github.com/repos/some/repo/issues/42/labels/rebase",
  },
]
`;

exports[`platform/github ensureComment add comment if not found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "body": "{\\"body\\":\\"### some-subject\\\\n\\\\nsome\\\\ncontent\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 44,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments",
  },
]
`;

exports[`platform/github ensureComment add updates comment if necessary 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "body": "{\\"body\\":\\"### some-subject\\\\n\\\\nsome\\\\ncontent\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 44,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/issues/comments/1234",
  },
]
`;

exports[`platform/github ensureComment adds comment if found in closed PR list 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"body\\":\\"### some-subject\\\\n\\\\nsome\\\\ncontent\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 44,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/issues/2499/comments",
  },
]
`;

exports[`platform/github ensureComment handles comment with no description 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
]
`;

exports[`platform/github ensureComment skips comment 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
]
`;

exports[`platform/github ensureCommentRemoval deletes comment by content if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "DELETE",
    "url": "https://api.github.com/repos/some/repo/issues/comments/1234",
  },
]
`;

exports[`platform/github ensureCommentRemoval deletes comment by topic if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/issues/42/comments?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "DELETE",
    "url": "https://api.github.com/repos/some/repo/issues/comments/1234",
  },
]
`;

exports[`platform/github ensureIssue() closes others if ensuring only once 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/3",
  },
]
`;

exports[`platform/github ensureIssue() creates issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"title\\":\\"new-title\\",\\"body\\":\\"new-content\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 42,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/undefined/issues",
  },
]
`;

exports[`platform/github ensureIssue() creates issue if not ensuring only once 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/1",
  },
]
`;

exports[`platform/github ensureIssue() creates issue if reopen flag false and issue is not open 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
  Object {
    "body": "{\\"title\\":\\"title-2\\",\\"body\\":\\"new-content\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 40,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/undefined/issues",
  },
]
`;

exports[`platform/github ensureIssue() deletes if duplicate 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"state\\":\\"closed\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 18,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/undefined/issues/1",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`platform/github ensureIssue() does not create issue if ensuring only once 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github ensureIssue() does not create issue if reopen flag false and issue is already open 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`platform/github ensureIssue() skips update if unchanged 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`platform/github ensureIssue() updates issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
  Object {
    "body": "{\\"body\\":\\"newer-content\\",\\"state\\":\\"open\\",\\"title\\":\\"title-3\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 57,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`platform/github ensureIssueClosing() closes issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"state\\":\\"closed\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 18,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`platform/github findIssue() finds issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/issues/2",
  },
]
`;

exports[`platform/github findIssue() returns null if no issue 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "issues": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "body": null,
              "number": null,
              "state": null,
              "title": null,
            },
            "pageInfo": Object {
              "endCursor": null,
              "hasNextPage": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 425,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github findPr(branchName, prTitle, state) caches pr list 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/pulls?per_page=100&state=all",
  },
]
`;

exports[`platform/github findPr(branchName, prTitle, state) returns true if no title and all state 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/pulls?per_page=100&state=all",
  },
]
`;

exports[`platform/github findPr(branchName, prTitle, state) returns true if not open 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/pulls?per_page=100&state=all",
  },
]
`;

exports[`platform/github getBranchPr(branchName) should return null if no PR exists 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
]
`;

exports[`platform/github getBranchPr(branchName) should return the PR object 1`] = `
Object {
  "additions": 1,
  "base": Object {
    "sha": "1234",
  },
  "branchName": "somebranch",
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 1,
  "deletions": 1,
  "displayNumber": "Pull Request #91",
  "head": Object {
    "ref": "somebranch",
    "repo": Object {
      "full_name": "some/repo",
    },
  },
  "isModified": false,
  "isStale": true,
  "number": 91,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getBranchPr(branchName) should return the PR object 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/91",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getBranchPr(branchName) should return the PR object in fork mode 1`] = `
Object {
  "additions": 1,
  "base": Object {
    "sha": "1234",
  },
  "branchName": "somebranch",
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 1,
  "deletions": 1,
  "displayNumber": "Pull Request #90",
  "head": Object {
    "ref": "somebranch",
    "repo": Object {
      "full_name": "other/repo",
    },
  },
  "isModified": false,
  "isStale": true,
  "number": 90,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getBranchPr(branchName) should return the PR object in fork mode 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/forks",
  },
  Object {
    "body": "{\\"sha\\":\\"1234\\",\\"force\\":true}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 27,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/forked/repo/git/refs/heads/master",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls?per_page=100&state=all",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/90",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/forked/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getBranchStatus() defaults to pending 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs",
  },
]
`;

exports[`platform/github getBranchStatus() return failed if unsupported requiredStatusChecks 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github getBranchStatus() returns success if requiredStatusChecks null 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github getBranchStatus() should fail if a check run has failed 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs",
  },
]
`;

exports[`platform/github getBranchStatus() should fail if a check run is pending 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs",
  },
]
`;

exports[`platform/github getBranchStatus() should pass through failed 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs",
  },
]
`;

exports[`platform/github getBranchStatus() should pass through success 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs",
  },
]
`;

exports[`platform/github getBranchStatus() should succeed if no status and all passed check runs 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.antiope-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/somebranch/check-runs",
  },
]
`;

exports[`platform/github getBranchStatusCheck returns null 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`platform/github getBranchStatusCheck returns state if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`platform/github getPr(prNo) should return PR from closed graphql result 1`] = `
Object {
  "body": "dummy body",
  "branchName": "renovate/delay-4.x",
  "comments": Array [
    Object {
      "body": ":tada: This PR is included in version 13.63.5 :tada:

The release is available on:
- [npm package (@latest dist-tag)](https://www.npmjs.com/package/renovate)
- [GitHub release](https://github.com/renovatebot/renovate/releases/tag/13.63.5)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:",
      "id": 420006957,
    },
  ],
  "displayNumber": "Pull Request #2499",
  "number": 2499,
  "state": "merged",
  "title": "build(deps): update dependency delay to v4.0.1",
}
`;

exports[`platform/github getPr(prNo) should return PR from closed graphql result 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github getPr(prNo) should return PR from graphql result 1`] = `
Object {
  "branchName": "renovate/jest-monorepo",
  "canMerge": false,
  "canMergeReason": "mergeStateStatus = DIRTY",
  "displayNumber": "Pull Request #2500",
  "hasAssignees": false,
  "hasReviewers": false,
  "isConflicted": true,
  "isModified": false,
  "isStale": true,
  "number": 2500,
  "state": "open",
  "targetBranch": "master",
  "title": "chore(deps): update dependency jest to v23.6.0",
}
`;

exports[`platform/github getPr(prNo) should return PR from graphql result 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return a PR object - 0 1`] = `
Object {
  "base": Object {
    "sha": "1234",
  },
  "displayNumber": "Pull Request #1",
  "mergeable": true,
  "merged_at": "sometime",
  "number": 1,
  "state": "closed",
}
`;

exports[`platform/github getPr(prNo) should return a PR object - 0 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;

exports[`platform/github getPr(prNo) should return a PR object - 1 1`] = `
Object {
  "base": Object {
    "sha": "1234",
  },
  "branchName": undefined,
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 1,
  "displayNumber": "Pull Request #1",
  "isConflicted": true,
  "isModified": false,
  "mergeable_state": "dirty",
  "number": 1,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getPr(prNo) should return a PR object - 1 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return a PR object - 2 1`] = `
Object {
  "base": Object {
    "sha": "5678",
  },
  "branchName": undefined,
  "canMerge": true,
  "commits": 1,
  "displayNumber": "Pull Request #1",
  "isModified": false,
  "isStale": true,
  "mergeable": true,
  "number": 1,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getPr(prNo) should return a PR object - 2 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return a not rebaseable PR if gitAuthor does not match 1 commit 1`] = `
Object {
  "base": Object {
    "sha": "1234",
  },
  "branchName": undefined,
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 1,
  "displayNumber": "Pull Request #1",
  "isConflicted": true,
  "isModified": true,
  "mergeable_state": "dirty",
  "number": 1,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getPr(prNo) should return a not rebaseable PR if gitAuthor does not match 1 commit 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/commits",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return a rebaseable PR despite multiple commits 1`] = `
Object {
  "base": Object {
    "sha": "1234",
  },
  "branchName": undefined,
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 2,
  "displayNumber": "Pull Request #1",
  "isConflicted": true,
  "isModified": false,
  "mergeable_state": "dirty",
  "number": 1,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getPr(prNo) should return a rebaseable PR despite multiple commits 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/commits",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return a rebaseable PR if gitAuthor matches 1 commit 1`] = `
Object {
  "base": Object {
    "sha": "1234",
  },
  "branchName": undefined,
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 1,
  "displayNumber": "Pull Request #1",
  "isConflicted": true,
  "isModified": false,
  "mergeable_state": "dirty",
  "number": 1,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getPr(prNo) should return a rebaseable PR if gitAuthor matches 1 commit 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/commits",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return a rebaseable PR if web-flow is second author 1`] = `
Object {
  "base": Object {
    "sha": "1234",
  },
  "branchName": undefined,
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 2,
  "displayNumber": "Pull Request #1",
  "isConflicted": true,
  "isModified": false,
  "mergeable_state": "dirty",
  "number": 1,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getPr(prNo) should return a rebaseable PR if web-flow is second author 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/commits",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return an unrebaseable PR if multiple authors 1`] = `
Object {
  "base": Object {
    "sha": "1234",
  },
  "branchName": undefined,
  "canMerge": false,
  "canMergeReason": "mergeable = undefined",
  "commits": 2,
  "displayNumber": "Pull Request #1",
  "isConflicted": true,
  "isModified": true,
  "mergeable_state": "dirty",
  "number": 1,
  "sha": undefined,
  "state": "open",
}
`;

exports[`platform/github getPr(prNo) should return an unrebaseable PR if multiple authors 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/commits",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github getPr(prNo) should return null if no PR is returned from GitHub 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "assignees": Object {
                "totalCount": null,
              },
              "baseRefName": null,
              "body": null,
              "commits": Object {
                "__args": Object {
                  "first": "2",
                },
                "nodes": Object {
                  "commit": Object {
                    "author": Object {
                      "email": null,
                    },
                    "committer": Object {
                      "email": null,
                    },
                    "parents": Object {
                      "__args": Object {
                        "last": "1",
                      },
                      "edges": Object {
                        "node": Object {
                          "abbreviatedOid": null,
                          "oid": null,
                        },
                      },
                    },
                  },
                },
              },
              "headRefName": null,
              "labels": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "name": null,
                },
              },
              "mergeStateStatus": null,
              "mergeable": null,
              "number": null,
              "reviewRequests": Object {
                "totalCount": null,
              },
              "reviews": Object {
                "__args": Object {
                  "first": "1",
                },
                "nodes": Object {
                  "state": null,
                },
              },
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.merge-info-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 1413,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "pullRequests": Object {
            "__args": Object {
              "first": "100",
            },
            "nodes": Object {
              "comments": Object {
                "__args": Object {
                  "last": "100",
                },
                "nodes": Object {
                  "body": null,
                  "databaseId": null,
                },
              },
              "headRefName": null,
              "number": null,
              "state": null,
              "title": null,
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 513,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;

exports[`platform/github getPrBody(input) returns not-updated pr body for GHE 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "github.company.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://github.company.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "github.company.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://github.company.com/user/emails",
  },
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "github.company.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://github.company.com/graphql",
  },
]
`;

exports[`platform/github getPrBody(input) returns updated pr body 1`] = `"https://github.com/foo/bar/issues/5 plus also [a link](https://togithub.com/foo/bar/issues/5)"`;

exports[`platform/github getRepoForceRebase should detect repoForceRebase 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`platform/github getRepoForceRebase should handle 403 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`platform/github getRepoForceRebase should handle 404 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`platform/github getRepoForceRebase should throw 401 1`] = `"Response code 401 (Unauthorized)"`;

exports[`platform/github getRepoForceRebase should throw 401 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/undefined/branches/undefined/protection",
  },
]
`;

exports[`platform/github getRepos should return an array of repos 1`] = `
Array [
  "a/b",
  "c/d",
]
`;

exports[`platform/github getRepos should return an array of repos 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
]
`;

exports[`platform/github getVulnerabilityAlerts() handles network error 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 697,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github getVulnerabilityAlerts() returns array if found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 697,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github getVulnerabilityAlerts() returns empty if disabled 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 697,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github getVulnerabilityAlerts() returns empty if error 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "undefined",
            "owner": "undefined",
          },
          "vulnerabilityAlerts": Object {
            "__args": Object {
              "last": "100",
            },
            "edges": Object {
              "node": Object {
                "dismissReason": null,
                "securityAdvisory": Object {
                  "description": null,
                  "identifiers": Object {
                    "type": null,
                    "value": null,
                  },
                  "references": Object {
                    "url": null,
                  },
                  "severity": null,
                },
                "securityVulnerability": Object {
                  "firstPatchedVersion": Object {
                    "identifier": null,
                  },
                  "package": Object {
                    "ecosystem": null,
                    "name": null,
                  },
                  "vulnerableVersionRange": null,
                },
                "vulnerableManifestFilename": null,
                "vulnerableManifestPath": null,
                "vulnerableRequirements": null,
              },
            },
          },
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.vixen-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 697,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initPlatform() should support custom endpoint 1`] = `
Object {
  "endpoint": "https://ghe.renovatebot.com/",
  "gitAuthor": "undefined <user@domain.com>",
  "renovateUsername": "renovate-bot",
}
`;

exports[`platform/github initPlatform() should support custom endpoint 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "ghe.renovatebot.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://ghe.renovatebot.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "ghe.renovatebot.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://ghe.renovatebot.com/user/emails",
  },
]
`;

exports[`platform/github initPlatform() should support default endpoint no email access 1`] = `
Object {
  "endpoint": "https://api.github.com/",
  "gitAuthor": undefined,
  "renovateUsername": "renovate-bot",
}
`;

exports[`platform/github initPlatform() should support default endpoint no email access 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user/emails",
  },
]
`;

exports[`platform/github initPlatform() should support default endpoint no email result 1`] = `
Object {
  "endpoint": "https://api.github.com/",
  "gitAuthor": undefined,
  "renovateUsername": "renovate-bot",
}
`;

exports[`platform/github initPlatform() should support default endpoint no email result 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user/emails",
  },
]
`;

exports[`platform/github initPlatform() should support default endpoint with email 1`] = `
Object {
  "endpoint": "https://api.github.com/",
  "gitAuthor": "undefined <user@domain.com>",
  "renovateUsername": "renovate-bot",
}
`;

exports[`platform/github initPlatform() should support default endpoint with email 2`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user/emails",
  },
]
`;

exports[`platform/github initPlatform() should throw if user failure 1`] = `
Array [
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user",
  },
]
`;

exports[`platform/github initRepo should fork when forkMode 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`platform/github initRepo should fork when forkMode 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/forks",
  },
]
`;

exports[`platform/github initRepo should merge 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`platform/github initRepo should merge 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initRepo should not guess at merge 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`platform/github initRepo should not guess at merge 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initRepo should rebase 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`platform/github initRepo should rebase 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initRepo should squash 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`platform/github initRepo should squash 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initRepo should throw err if disabled in renovate.json 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/contents/renovate.json",
  },
]
`;

exports[`platform/github initRepo should throw error if archived 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initRepo should throw error if renamed 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initRepo should update fork when forkMode 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`platform/github initRepo should update fork when forkMode 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/git/refs/heads/master",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/user/repos?per_page=100",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/forks",
  },
  Object {
    "body": "{\\"sha\\":\\"1234\\",\\"force\\":true}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 27,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/forked_repo/git/refs/heads/master",
  },
]
`;

exports[`platform/github initRepo should use different header in app mode 1`] = `
Object {
  "defaultBranch": "master",
  "isFork": false,
}
`;

exports[`platform/github initRepo should use different header in app mode 2`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.machine-man-preview+json, application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github initRepo throws not-found 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
]
`;

exports[`platform/github mergePr(prNo) - autodetection should give up 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": "{\\"merge_method\\":\\"squash\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": "{\\"merge_method\\":\\"merge\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 24,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
]
`;

exports[`platform/github mergePr(prNo) - autodetection should try merge after squash 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
  Object {
    "body": "{\\"merge_method\\":\\"squash\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1237/merge",
  },
]
`;

exports[`platform/github mergePr(prNo) - autodetection should try rebase first 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1235/merge",
  },
]
`;

exports[`platform/github mergePr(prNo) - autodetection should try squash after rebase 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1236/merge",
  },
]
`;

exports[`platform/github mergePr(prNo) should handle merge error 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/merge",
  },
]
`;

exports[`platform/github mergePr(prNo) should merge the PR 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"merge_method\\":\\"rebase\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 25,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PUT",
    "url": "https://api.github.com/repos/some/repo/pulls/1234/merge",
  },
]
`;

exports[`platform/github setBranchStatus returns if already set 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`platform/github setBranchStatus sets branch status 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
  Object {
    "body": "{\\"state\\":\\"success\\",\\"description\\":\\"some-description\\",\\"context\\":\\"some-context\\",\\"target_url\\":\\"some-url\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 101,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/repos/some/repo/statuses/0d9c7726c3d628b7e28af234595cfd20febdbf8e",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/some-branch/status",
  },
  Object {
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "GET",
    "url": "https://api.github.com/repos/some/repo/commits/0d9c7726c3d628b7e28af234595cfd20febdbf8e/statuses",
  },
]
`;

exports[`platform/github updatePr(prNo, title, body) should update the PR 1`] = `
Array [
  Object {
    "graphql": Object {
      "query": Object {
        "repository": Object {
          "__args": Object {
            "name": "repo",
            "owner": "some",
          },
          "defaultBranchRef": Object {
            "name": null,
          },
          "isArchived": null,
          "isFork": null,
          "mergeCommitAllowed": null,
          "nameWithOwner": null,
          "rebaseMergeAllowed": null,
          "squashMergeAllowed": null,
        },
      },
    },
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 280,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "POST",
    "url": "https://api.github.com/graphql",
  },
  Object {
    "body": "{\\"title\\":\\"The New Title\\",\\"body\\":\\"Hello world again\\"}",
    "headers": Object {
      "accept": "application/vnd.github.v3+json",
      "accept-encoding": "gzip, deflate",
      "authorization": "token abc123",
      "content-length": 52,
      "content-type": "application/json",
      "host": "api.github.com",
      "user-agent": "https://github.com/renovatebot/renovate",
    },
    "method": "PATCH",
    "url": "https://api.github.com/repos/some/repo/pulls/1234",
  },
]
`;
